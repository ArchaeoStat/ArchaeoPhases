<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to ArchaeoPhases • ArchaeoPhases</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ArchaeoPhases">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ArchaeoPhases</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ArchaeoPhases.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/import.html">Import MCMC Samples</a></li>
    <li><a class="dropdown-item" href="../articles/allen.html">Allen's interval algebra</a></li>
    <li><a class="dropdown-item" href="../articles/bibliography.html">Bibliography</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ArchaeoStat/ArchaeoPhases/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to ArchaeoPhases</h1>
                        <h4 data-toc-skip class="author">A. Philippe,
M.-A. Vibet</h4>
            
            <h4 data-toc-skip class="date">2024-11-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ArchaeoStat/ArchaeoPhases/blob/master/vignettes/ArchaeoPhases.Rmd" class="external-link"><code>vignettes/ArchaeoPhases.Rmd</code></a></small>
      <div class="d-none name"><code>ArchaeoPhases.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>ArchaeoPhases</strong> provides a list of functions for the
statistical analysis of archaeological dates and groups of dates. It is
based on the post-processing of the Markov Chains whose stationary
distribution is the posterior distribution of a series of dates. Such
MCMC output can be simulated by different applications as for instance
<a href="https://chronomodel.com/" class="external-link">ChronoModel</a> <span class="citation">(Lanos et al. 2020)</span>, <a href="https://c14.arch.ox.ac.uk/oxcal.html" class="external-link">Oxcal</a> <span class="citation">(Bronk Ramsey 2009)</span> or <a href="https://bcal.shef.ac.uk/" class="external-link">BCal</a> <span class="citation">(Buck,
Christen, and James 1999)</span>. The only requirement is to have a CSV
file containing a sample from the posterior distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ArchaeoStat.github.io/ArchaeoPhases/">ArchaeoPhases</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span> <span class="co"># MCMC diagnostic</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="import-data">Import data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h2>
<p>This vignette uses data available through the <a href="https://github.com/ArchaeoStat/ArchaeoData" class="external-link"><strong>ArchaeoData</strong></a>
package which is available in a <a href="https://archaeostat.r-universe.dev" class="external-link">separate repository</a>.
<strong>ArchaeoData</strong> provides MCMC outputs from ChronoModel,
OxCal and BCal.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Install data package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ArchaeoData"</span>, repos <span class="op">=</span> <span class="st">"https://archaeostat.r-universe.dev"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s use the data of Ksar Akil generated by ChronoModel <span class="citation">(Bosch et al. 2015)</span>.</p>
<p>Two different files are generated by ChronoModel:
<code>Chain_all_Events.csv</code> that contains the MCMC samples of each
event created in the modeling, and <code>Chain_all_Phases.csv</code>
that contains all the MCMC samples of the minimum and the maximum of
each group of dates if at least one group is created.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Construct the path to the data</span></span>
<span><span class="va">chrono_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"chronomodel"</span>, <span class="st">"ksarakil"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Read events from ChronoModel</span></span>
<span><span class="va">output_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="va">chrono_path</span>, <span class="st">"Chain_all_Events.csv"</span>, package <span class="op">=</span> <span class="st">"ArchaeoData"</span><span class="op">)</span></span>
<span><span class="va">chrono_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_chronomodel.html">read_chronomodel_events</a></span><span class="op">(</span><span class="va">output_events</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Read phases from ChronoModel</span></span>
<span><span class="va">output_phases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="va">chrono_path</span>, <span class="st">"Chain_all_Phases.csv"</span>, package <span class="op">=</span> <span class="st">"ArchaeoData"</span><span class="op">)</span></span>
<span><span class="va">chrono_phases</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_chronomodel.html">read_chronomodel_phases</a></span><span class="op">(</span><span class="va">output_phases</span><span class="op">)</span></span></code></pre></div>
<p>See <code><a href="../articles/import.html">vignette("import")</a></code> for more details on how to import
MCMC samples.</p>
</div>
<div class="section level2">
<h2 id="convergence-of-mcmc-chains">Convergence of MCMC chains<a class="anchor" aria-label="anchor" href="#convergence-of-mcmc-chains"></a>
</h2>
<p>For more details on the diagnostic of Markov chain, see <span class="citation">Robert and Casella (2010)</span>.</p>
<p>To assess the agreement between the posterior distributions and the
numerical approximations, three Markov chains were run in parallel by
ChronoModel. For each chain, 1 000 iterations were used during the
Burn-in period, 20 batches of 500 iterations were used in the Adapt
period, 100 000 iterations were drawn in the Acquire period by only 1
out of 10 were kept in order to break the correlation structure.</p>
<p>From the analysis of the history plot, all Markov chains reach their
equilibrium before the Acquire period. The autocorrelations of the three
Markov chains are not significant, meaning the rate of subsample (1 over
10) is enough.</p>
<p>Now, using the package <strong>ArchaeoPhases</strong> and the package
<strong>coda</strong>, we can verify whether the MCMC samples are
correctly generated by the software.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create an mcmc.list</span></span>
<span><span class="va">coda_events</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/as_coda.html">as_coda</a></span><span class="op">(</span><span class="va">chrono_events</span>, chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>Indeed, the MCMC samples should have no autocorrelation and should
have reached their equilibrium (that is the posterior density of the
parameter under investigation).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/autocorr.plot.html" class="external-link">autocorr.plot</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Fcoda-autocor-1.png" alt="plot of chunk coda-autocor" width="100%"><p class="caption">
plot of chunk coda-autocor
</p>
</div>
<div class="figure">
<img src="figures%2Fcoda-autocor-2.png" alt="plot of chunk coda-autocor" width="100%"><p class="caption">
plot of chunk coda-autocor
</p>
</div>
<p>The autocorrelation plots show that each of these three chains are
not significant. That means that we actually generated a non correlated
sample, which was the aim the MCMC process.</p>
<p>We can also check whether the chains reached equilibrium. For
example, let’s consider the first date of the dataset.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">[</span>, <span class="fl">1</span>, <span class="op">]</span>, trace <span class="op">=</span> <span class="cn">TRUE</span>, density <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Fcoda-plot-1.png" alt="plot of chunk coda-plot" width="100%"><p class="caption">
plot of chunk coda-plot
</p>
</div>
<p>The plot shows that the three chains corresponding to the first date
reached the same stationary process.</p>
<p>We can test the Gelman-Rubin criterion. The expected value to confirm
that all of the Markov chains reached equilibrium is 1.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/gelman.diag.html" class="external-link">gelman.diag</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">)</span></span>
<span><span class="co">#&gt; Potential scale reduction factors:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Point est. Upper C.I.</span></span>
<span><span class="co">#&gt;  [1,]          1          1</span></span>
<span><span class="co">#&gt;  [2,]          1          1</span></span>
<span><span class="co">#&gt;  [3,]          1          1</span></span>
<span><span class="co">#&gt;  [4,]          1          1</span></span>
<span><span class="co">#&gt;  [5,]          1          1</span></span>
<span><span class="co">#&gt;  [6,]          1          1</span></span>
<span><span class="co">#&gt;  [7,]          1          1</span></span>
<span><span class="co">#&gt;  [8,]          1          1</span></span>
<span><span class="co">#&gt;  [9,]          1          1</span></span>
<span><span class="co">#&gt; [10,]          1          1</span></span>
<span><span class="co">#&gt; [11,]          1          1</span></span>
<span><span class="co">#&gt; [12,]          1          1</span></span>
<span><span class="co">#&gt; [13,]          1          1</span></span>
<span><span class="co">#&gt; [14,]          1          1</span></span>
<span><span class="co">#&gt; [15,]          1          1</span></span>
<span><span class="co">#&gt; [16,]          1          1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate psrf</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 1</span></span></code></pre></div>
<p>The Gelman-Rubin criterion confirms that all of the Markov chains
reached equilibrium.</p>
<p>We can also test the Geweke criterion. The expected value to confirm
that all of the Markov chains reached equilibrium is strickly less than
1.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">coda</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/geweke.diag.html" class="external-link">geweke.diag</a></span><span class="op">(</span><span class="va">coda_events</span><span class="op">[</span>, <span class="fl">1</span>, <span class="op">]</span>, frac1 <span class="op">=</span> <span class="fl">0.1</span>, frac2 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fraction in 1st window = 0.1</span></span>
<span><span class="co">#&gt; Fraction in 2nd window = 0.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   var1 </span></span>
<span><span class="co">#&gt; 0.4978 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fraction in 1st window = 0.1</span></span>
<span><span class="co">#&gt; Fraction in 2nd window = 0.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   var1 </span></span>
<span><span class="co">#&gt; 0.7736 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fraction in 1st window = 0.1</span></span>
<span><span class="co">#&gt; Fraction in 2nd window = 0.5 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   var1 </span></span>
<span><span class="co">#&gt; 0.7666</span></span></code></pre></div>
<p>The Geweke criterion criterion confirms that all of the Markov chains
reached equilibrium.</p>
<p>ChronoModel generated correct samples of the posterior distribution.
Now gathering the three chains, a total of 30 000 iterations was
collected in order to give estimations of the posterior distribution of
each parameter.</p>
</div>
<div class="section level2">
<h2 id="analysis-of-a-series-of-dates">Analysis of a series of dates<a class="anchor" aria-label="anchor" href="#analysis-of-a-series-of-dates"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chrono_events</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Fevent-plot-1.png" alt="plot of chunk event-plot" width="100%"><p class="caption">
plot of chunk event-plot
</p>
</div>
<div class="section level3">
<h3 id="tempo-plot">Tempo Plot<a class="anchor" aria-label="anchor" href="#tempo-plot"></a>
</h3>
<p>The tempo plot has been introduced by <span class="citation">Dye
(2016)</span>. See <span class="citation">Philippe and Vibet
(2020)</span> for more statistical details.</p>
<p>The tempo plot is one way to measure change over time: it estimates
the cumulative occurrence of archaeological events in a Bayesian
calibration. The tempo plot yields a graphic where the slope of the plot
directly reflects the pace of change: a period of rapid change yields a
steep slope and a period of slow change yields a gentle slope. When
there is no change, the plot is horizontal. When change is
instantaneous, the plot is vertical.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Warning: this may take a few seconds</span></span>
<span><span class="va">tp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tempo.html">tempo</a></span><span class="op">(</span><span class="va">chrono_events</span>, level <span class="op">=</span> <span class="fl">0.95</span>, count <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tp</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Ftempo-plot-1.png" alt="plot of chunk tempo-plot" width="100%"><p class="caption">
plot of chunk tempo-plot
</p>
</div>
<p>From these graphs, we can see that the highest part of the sampled
activity is dated between -45 000 to -35 000 but two dates are younger,
at about -32 000 and -28 000.</p>
</div>
<div class="section level3">
<h3 id="activity-plot">Activity Plot<a class="anchor" aria-label="anchor" href="#activity-plot"></a>
</h3>
<p>The activity plot displays the derivative of the Bayes estimate of
the Tempo plot. It is an other way to see changes over time.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Warning: this may take a few seconds</span></span>
<span><span class="va">ac</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/activity.html">activity</a></span><span class="op">(</span><span class="va">tp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ac</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Factivity-plot-1.png" alt="plot of chunk activity-plot" width="100%"><p class="caption">
plot of chunk activity-plot
</p>
</div>
</div>
<div class="section level3">
<h3 id="occurrence-plot">Occurrence Plot<a class="anchor" aria-label="anchor" href="#occurrence-plot"></a>
</h3>
<p>The Occurrence plot calculates the calendar date
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
corresponding to the smallest date such that the number of events
observed before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>,
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>16</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">k = [(1, 16)]</annotation></semantics></math>.
The Occurrence plot draws the credible intervals or the highest
posterior density (HPD) region of those dates associated to a desired
level of confidence.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Warning: this may take a few seconds</span></span>
<span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/occurrence.html">occurrence</a></span><span class="op">(</span><span class="va">chrono_events</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">oc</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Foccurrence-plot-1.png" alt="plot of chunk occurrence-plot" width="100%"><p class="caption">
plot of chunk occurrence-plot
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="analysis-of-groups-of-dates">Analysis of groups of dates<a class="anchor" aria-label="anchor" href="#analysis-of-groups-of-dates"></a>
</h2>
<div class="section level3">
<h3 id="groups-of-dates">Groups of dates<a class="anchor" aria-label="anchor" href="#groups-of-dates"></a>
</h3>
<p>A group of dates (phase) is defined by the date of the minimum and
the date of the maximum of the group. In this part, we will use the data
containing these values for each group of dates.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Build phases from events</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>EPI <span class="op">=</span> <span class="fl">1</span>, UP <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, Ahmarian <span class="op">=</span> <span class="fl">5</span><span class="op">:</span><span class="fl">15</span>, IUP <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">chrono_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phases.html">phases</a></span><span class="op">(</span><span class="va">chrono_events</span>, groups <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">chrono_groups</span> <span class="op">==</span> <span class="va">chrono_phases</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We can estimate the time range of a group of dates as the shortest
interval that contains all the dates of the group at a given confidence
level <span class="citation">(Philippe and Vibet 2020)</span>.</p>
<p>The following code gives the endpoints of the time range of all
groups of dates of Ksar Akil data at a given confidence level.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bound</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boundaries.html">boundaries</a></span><span class="op">(</span><span class="va">chrono_groups</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bound</span><span class="op">)</span></span>
<span><span class="co">#&gt;              start       end duration</span></span>
<span><span class="co">#&gt; EPI      -28978.53 -26969.82 2009.709</span></span>
<span><span class="co">#&gt; UP       -38570.37 -29368.75 9202.620</span></span>
<span><span class="co">#&gt; Ahmarian -42168.47 -37433.31 4736.161</span></span>
<span><span class="co">#&gt; IUP      -43240.37 -41161.00 2080.371</span></span></code></pre></div>
<p>The time range interval of the group of dates is a way to summarize
the estimation of its minimum, the estimation of its maximum and their
uncertainties at the same time.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chrono_groups</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Fphases-plot-1.png" alt="plot of chunk phases-plot" width="100%"><p class="caption">
plot of chunk phases-plot
</p>
</div>
</div>
<div class="section level3">
<h3 id="succession-of-groups">Succession of groups<a class="anchor" aria-label="anchor" href="#succession-of-groups"></a>
</h3>
<p>We may also be interested in a succession of phases. This is actually
the case of the succession of <em>IUP</em>, <em>Ahmarian</em>,
<em>UP</em> and <em>EPI</em> that are in stratigraphic order. Hence, we
can estimate the transition interval and, if it exists, the gap between
these successive phases.</p>
<div class="section level4">
<h4 id="transistions-between-successive-groups">Transistions between successive groups<a class="anchor" aria-label="anchor" href="#transistions-between-successive-groups"></a>
</h4>
<p>The transition interval between two successive phases is the shortest
interval that covers the end of the oldest group of dates and the start
of the youngest group of dates. The start and the end are estimated by
the minimum and the maximum of the dates included in the group of dates.
It gives an idea of the transition period between two successive group
of dates. From a computational point of view this is equivalent to the
time range calculated between the end of the oldest group of dates and
the start of the youngest group of dates.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/transition.html">transition</a></span><span class="op">(</span><span class="va">chrono_groups</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">trans</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  start       end  duration</span></span>
<span><span class="co">#&gt; UP-EPI       -31479.79 -26905.04  4575.756</span></span>
<span><span class="co">#&gt; Ahmarian-EPI -39138.82 -27122.05 12017.766</span></span>
<span><span class="co">#&gt; IUP-EPI      -43487.53 -26866.99 16621.537</span></span>
<span><span class="co">#&gt; Ahmarian-UP  -39118.07 -36741.08  2377.983</span></span>
<span><span class="co">#&gt; IUP-UP       -43395.89 -36480.26  6916.631</span></span>
<span><span class="co">#&gt; IUP-Ahmarian -43212.31 -40733.77  2479.539</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gap-between-successive-groups">Gap between successive groups<a class="anchor" aria-label="anchor" href="#gap-between-successive-groups"></a>
</h4>
<p>Successive phases may also be separated in time. Indeed there may
exist a gap between them. This testing procedure check whether a gap
exists between two successive groups of dates with fixed probability. If
a gap exists, it is an interval that covers the end of one group of
dates and the start of the successive one with fixed posterior
probability.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hia</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hiatus.html">hiatus</a></span><span class="op">(</span><span class="va">chrono_groups</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">hia</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  start       end   duration</span></span>
<span><span class="co">#&gt; UP-EPI       -29188.56 -28961.79   227.7663</span></span>
<span><span class="co">#&gt; Ahmarian-EPI -37368.33 -28884.37  8484.9583</span></span>
<span><span class="co">#&gt; IUP-EPI      -41220.64 -28814.70 12406.9352</span></span>
<span><span class="co">#&gt; IUP-UP       -41282.64 -38421.49  2862.1447</span></span></code></pre></div>
<p>At a confidence level of 95%, there is no gap between the succession
of phases <em>IUP</em>, <em>Ahmarian</em> and <em>UP</em>, but there
exists one of 203 years between phase <em>UP</em> and phase
<em>EPI</em>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">chrono_groups</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UP"</span>, <span class="st">"EPI"</span><span class="op">)</span>, <span class="op">]</span>, succession <span class="op">=</span> <span class="st">"hiatus"</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="figures%2Fsuccession-plot-1.png" alt="plot of chunk succession-plot" width="100%"><p class="caption">
plot of chunk succession-plot
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bosch2015" class="csl-entry">
Bosch, Marjolein D., Marcello A. Mannino, Amy L. Prendergast, Tamsin C.
O’Connell, Beatrice Demarchi, Sheila M. Taylor, Laura Niven, Johannes
van der Plicht, and Jean-Jacques Hublin. 2015. <span>“New Chronology for
<span>Ksâr</span> ‘<span>Akil</span> (<span>Lebanon</span>) Supports
<span>Levantine</span> Route of Modern Human Dispersal into
<span>Europe</span>.”</span> <em>Proceedings of the National Academy of
Sciences</em> 112 (25): 7683–88. <a href="https://doi.org/10.1073/pnas.1501529112" class="external-link">https://doi.org/10.1073/pnas.1501529112</a>.
</div>
<div id="ref-bronkramsey2009" class="csl-entry">
Bronk Ramsey, Christopher. 2009. <span>“Bayesian <span>Analysis</span>
of <span>Radiocarbon Dates</span>.”</span> <em>Radiocarbon</em> 51 (1):
337–60. <a href="https://doi.org/10.1017/S0033822200033865" class="external-link">https://doi.org/10.1017/S0033822200033865</a>.
</div>
<div id="ref-buck1999" class="csl-entry">
Buck, C. E., J. A. Christen, and G. E. James. 1999.
<span>“<span>BCal</span>: An on-Line <span>Bayesian</span> Radiocarbon
Calibration Tool.”</span> <em>Internet Archaeology</em> 7. <a href="https://doi.org/10.11141/ia.7.1" class="external-link">https://doi.org/10.11141/ia.7.1</a>.
</div>
<div id="ref-dye2016" class="csl-entry">
Dye, Thomas S. 2016. <span>“Long-Term Rhythms in the Development of
<span>Hawaiian</span> Social Stratification.”</span> <em>Journal of
Archaeological Science</em> 71 (July): 1–9. <a href="https://doi.org/10.1016/j.jas.2016.05.006" class="external-link">https://doi.org/10.1016/j.jas.2016.05.006</a>.
</div>
<div id="ref-lanos2020" class="csl-entry">
Lanos, Ph., A. Philippe, H. Lanos, and Ph. Dufresne. 2020.
<span>“Chronomodel: <span>Chronological</span> Modeling of
Archaeological Data Using Bayesian Statistics.”</span>
<span>CNRS</span>. <a href="https://chronomodel.com" class="external-link">https://chronomodel.com</a>.
</div>
<div id="ref-philippe2020" class="csl-entry">
Philippe, Anne, and Marie-Anne Vibet. 2020. <span>“Analysis of
<span>Archaeological Phases Using</span> the <span>R Package
ArchaeoPhases</span>.”</span> <em>Journal of Statistical Software</em>
93. <a href="https://doi.org/10.18637/jss.v093.c01" class="external-link">https://doi.org/10.18637/jss.v093.c01</a>.
</div>
<div id="ref-robert2010" class="csl-entry">
Robert, Christian P., and George Casella. 2010. <em>Introducing
<span>Monte Carlo</span> Methods with <span>R</span></em>. Use
<span>R</span>! <span>New York</span>: <span>Springer</span>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anne Philippe, Marie-Anne Vibet, Nicolas Frerebeau.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
